<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
   <title>Wireless Networking</title>
   <link rel="stylesheet" href="css/main.css" type="text/css" media="screen">
   <script language="JavaScript" type="text/javascript" src="javascript/jquery.js"></script>
   <script language="JavaScript" type="text/javascript">
      $.ajaxSetup({
         type: 'GET',
         dataType: 'jsonp',
         timeout: 3000,
         cache: false,
         global: false
      });

      $(document).ready(function()
         {
         scanForWirelessNetworks();
         });

      function scanForWirelessNetworks()
         {
         var wirelessNetworks = null;

         $("#networkList").text("Scanning...");

         // load the network list
         $.ajax(
         {
            url: '/cgi-bin/getWirelessNetworksAsJSON.pl',
            success: function(wirelessNetworksJSON)
               {
               if (wirelessNetworksJSON && wirelessNetworksJSON['wireless-networks'])
                  {
                  wirelessNetworks = wirelessNetworksJSON['wireless-networks'];
                  }
               displayNetworkList(wirelessNetworks);
               },
            error: function(XMLHttpRequest, textStatus, errorThrown)
               {
               displayNetworkList(wirelessNetworks);
               }
         });
         }

      function displayNetworkList(wirelessNetworks)
         {
         if (wirelessNetworks && wirelessNetworks.length > 0)
            {
            $("#networkList").empty();
            $("#networkList").append('<table id="networkListTable" border="0" cellpadding="0" cellspacing="0"></table>');
            $("#networkListTable").append('<tr><td class="table-heading">Network Name</td><td><img src="images/clear.gif" alt="" width="20" height="5"/></td><td class="table-heading">Encrypted</th></tr>');
            for (var i = 0; i < wirelessNetworks.length; i++)
               {
               if (i > 0)
                  {
                  $("#networkListTable").append('<tr><td colspan="3"><img src="images/clear.gif" alt="" width="3" height="3"/></td></tr>');
                  }
               var lock = (wirelessNetworks[i]['is-encrypted']) ? '<img src="images/lock.png" width="9" height="11" border="0" alt=""/>' : '&nbsp;';   
               $("#networkListTable").append('<tr><td>' + wirelessNetworks[i]['ssid'] + '</td><td><img src="images/clear.gif" alt="" width="5" height="5"/></td><td align="center">'+lock+'</td></tr>');
               }
            }
         else
            {
            $("#networkList").text("No wireless networks found.");
            }
         }
   </script>
</head>
<body>
<div class="page-title">Wireless Networking</div>
<div id="statusArea" style="display:none">
   <table border="1" cellpadding="0" cellspacing="0">
      <tr>
         <td valign="top">Status</td>
         <td>&nbsp;</td>
         <td>
            STATUS_GOES_HERE<br>
            Description of status goes here.
         </td>
      </tr>
   </table>
</div>
<div id="networkListArea">
   <div id="networkList">
      Scanning...
   </div>
</div>
</body>
</html>